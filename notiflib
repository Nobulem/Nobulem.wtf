--[[
nobulem.wtf - notificationlib.luau
]]
local NotificationLibrary = {}
NotificationLibrary.__index = NotificationLibrary

local CONFIG = {
	Position = UDim2.new(1, -20, 0, 20),
	Size = UDim2.new(0, 350, 0, 0),
	Padding = 8,
	AnimationSpeed = 0.3,
	DisplayTime = 4,
	MaxNotifications = 5,
	
	Colors = {
		Background = Color3.fromRGB(20, 20, 25),
		Border = Color3.fromRGB(60, 60, 70),
		AccentHit = Color3.fromRGB(150, 255, 150),
		AccentMiss = Color3.fromRGB(255, 100, 100),
		AccentInfo = Color3.fromRGB(100, 150, 255),
		Text = Color3.fromRGB(220, 220, 230),
		TextDim = Color3.fromRGB(150, 150, 160)
	}
}

function NotificationLibrary.new()
	local self = setmetatable({}, NotificationLibrary)
	
	self.ScreenGui = Instance.new("ScreenGui")
	self.ScreenGui.Name = "FatalityNotifications"
	self.ScreenGui.ResetOnSpawn = false
	self.ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
	self.ScreenGui.Parent = game:GetService("CoreGui")
	
	self.Container = Instance.new("Frame")
	self.Container.Name = "Container"
	self.Container.Position = CONFIG.Position
	self.Container.Size = CONFIG.Size
	self.Container.BackgroundTransparency = 1
	self.Container.AnchorPoint = Vector2.new(1, 0)
	self.Container.Parent = self.ScreenGui
	
	local layout = Instance.new("UIListLayout")
	layout.Padding = UDim.new(0, CONFIG.Padding)
	layout.SortOrder = Enum.SortOrder.LayoutOrder
	layout.VerticalAlignment = Enum.VerticalAlignment.Top
	layout.Parent = self.Container
	
	self.Notifications = {}
	self.NotificationCount = 0
	
	return self
end

function NotificationLibrary:CreateNotification(config)
	if #self.Notifications >= CONFIG.MaxNotifications then
		self:RemoveNotification(self.Notifications[1])
	end
	
	local notif = Instance.new("Frame")
	notif.Name = "Notification"
	notif.Size = UDim2.new(1, 0, 0, 0)
	notif.BackgroundColor3 = CONFIG.Colors.Background
	notif.BorderSizePixel = 0
	notif.ClipsDescendants = true
	notif.LayoutOrder = self.NotificationCount
	self.NotificationCount = self.NotificationCount + 1
	
	local accent = Instance.new("Frame")
	accent.Name = "Accent"
	accent.Size = UDim2.new(0, 2, 1, 0)
	accent.Position = UDim2.new(0, 0, 0, 0)
	accent.BorderSizePixel = 0
	accent.BackgroundColor3 = config.AccentColor or CONFIG.Colors.AccentInfo
	accent.Parent = notif
	
	local gradient = Instance.new("UIGradient")
	gradient.Rotation = 90
	gradient.Transparency = NumberSequence.new({
		NumberSequenceKeypoint.new(0, 0),
		NumberSequenceKeypoint.new(1, 0.5)
	})
	gradient.Parent = accent
	
	local content = Instance.new("Frame")
	content.Name = "Content"
	content.Size = UDim2.new(1, -16, 1, -12)
	content.Position = UDim2.new(0, 12, 0, 6)
	content.BackgroundTransparency = 1
	content.Parent = notif
	
	local title = Instance.new("TextLabel")
	title.Name = "Title"
	title.Size = UDim2.new(1, 0, 0, 16)
	title.Position = UDim2.new(0, 0, 0, 0)
	title.BackgroundTransparency = 1
	title.Text = config.Title or "Notification"
	title.TextColor3 = CONFIG.Colors.Text
	title.TextSize = 13
	title.Font = Enum.Font.GothamBold
	title.TextXAlignment = Enum.TextXAlignment.Left
	title.TextYAlignment = Enum.TextYAlignment.Top
	title.Parent = content
	
	local desc = Instance.new("TextLabel")
	desc.Name = "Description"
	desc.Size = UDim2.new(1, 0, 0, 14)
	desc.Position = UDim2.new(0, 0, 0, 18)
	desc.BackgroundTransparency = 1
	desc.Text = config.Description or ""
	desc.TextColor3 = CONFIG.Colors.TextDim
	desc.TextSize = 11
	desc.Font = Enum.Font.Gotham
	desc.TextXAlignment = Enum.TextXAlignment.Left
	desc.TextYAlignment = Enum.TextYAlignment.Top
	desc.Parent = content
	
	if config.Stats then
		local stats = Instance.new("TextLabel")
		stats.Name = "Stats"
		stats.Size = UDim2.new(1, 0, 0, 12)
		stats.Position = UDim2.new(0, 0, 0, 34)
		stats.BackgroundTransparency = 1
		stats.Text = config.Stats
		stats.TextColor3 = config.AccentColor or CONFIG.Colors.AccentInfo
		stats.TextSize = 10
		stats.Font = Enum.Font.GothamMedium
		stats.TextXAlignment = Enum.TextXAlignment.Left
		stats.TextYAlignment = Enum.TextYAlignment.Top
		stats.Parent = content
	end
	
	local shadow = Instance.new("ImageLabel")
	shadow.Name = "Shadow"
	shadow.BackgroundTransparency = 1
	shadow.Position = UDim2.new(0, -15, 0, -15)
	shadow.Size = UDim2.new(1, 30, 1, 30)
	shadow.ZIndex = 0
	shadow.Image = "rbxasset://textures/ui/GuiImagePlaceholder.png"
	shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
	shadow.ImageTransparency = 0.7
	shadow.ScaleType = Enum.ScaleType.Slice
	shadow.SliceCenter = Rect.new(10, 10, 118, 118)
	shadow.Parent = notif
	
	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(0, 4)
	corner.Parent = notif
	
	notif.Parent = self.Container
	table.insert(self.Notifications, notif)
	
	local height = 48
	if config.Stats then height = height + 14 end
	
	game:GetService("TweenService"):Create(
		notif,
		TweenInfo.new(CONFIG.AnimationSpeed, Enum.EasingStyle.Quart, Enum.EasingDirection.Out),
		{Size = UDim2.new(1, 0, 0, height)}
	):Play()
	
	task.delay(CONFIG.DisplayTime, function()
		self:RemoveNotification(notif)
	end)
	
	return notif
end

function NotificationLibrary:RemoveNotification(notif)
	if not notif or not notif.Parent then return end
	
	local tween = game:GetService("TweenService"):Create(
		notif,
		TweenInfo.new(CONFIG.AnimationSpeed, Enum.EasingStyle.Quart, Enum.EasingDirection.In),
		{Size = UDim2.new(1, 0, 0, 0)}
	)
	
	tween:Play()
	tween.Completed:Connect(function()
		for i, v in ipairs(self.Notifications) do
			if v == notif then
				table.remove(self.Notifications, i)
				break
			end
		end
		notif:Destroy()
	end)
end

function NotificationLibrary:Hit(target, damage, hitbox)
	return self:CreateNotification({
		Title = "HIT",
		Description = string.format("Hit %s in the %s", target, hitbox or "body"),
		Stats = string.format("Damage: %d", damage or 0),
		AccentColor = CONFIG.Colors.AccentHit
	})
end

function NotificationLibrary:Miss(target, reason)
	return self:CreateNotification({
		Title = "MISS",
		Description = string.format("Missed %s", target),
		Stats = reason or "Spread",
		AccentColor = CONFIG.Colors.AccentMiss
	})
end

function NotificationLibrary:Info(title, description, stats)
	return self:CreateNotification({
		Title = title,
		Description = description,
		Stats = stats,
		AccentColor = CONFIG.Colors.AccentInfo
	})
end

function NotificationLibrary:Destroy()
	if self.ScreenGui then
		self.ScreenGui:Destroy()
	end
end

return NotificationLibrary
